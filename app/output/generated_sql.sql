-- Rule ID: SAMPLE_TABLE1_FIELD1 NOT_NULL
SELECT 
       'SAMPLE_TABLE1_FIELD1 NOT_NULL' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is null' as MESSAGE
FROM TABLE1
WHERE TABLE1.FIELD1 IS NULL
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 NOT_NULL with success
SELECT 
       'SAMPLE_TABLE1_FIELD1 NOT_NULL with success' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is null' as MESSAGE
FROM TABLE1
WHERE TABLE1.FIELD1 IS NULL
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 values check
SELECT 
       'SAMPLE_TABLE1_FIELD1 values check' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is not in (valore1, valore2)' as MESSAGE
FROM TABLE1
WHERE NOT ( TABLE1.FIELD1 IN (valore1, valore2) )
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 values check between two field
SELECT 
       'SAMPLE_TABLE1_FIELD1 values check between two field' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is not correct' as MESSAGE
FROM TABLE1
WHERE NOT ( TABLE1.FIELD1 = TABLE1.FIELD2 * TABLE1.FIELD3 )
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 values check between two field using on_success
SELECT 
       'SAMPLE_TABLE1_FIELD1 values check between two field using on_success' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is not correct' as MESSAGE
FROM TABLE1
WHERE TABLE1.FIELD1 != TABLE1.FIELD2 * TABLE1.FIELD3
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 Simple FK on TABLE2 PK
SELECT 
       'SAMPLE_TABLE1_FIELD1 Simple FK on TABLE2 PK' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is not in table TABLE2' as MESSAGE
FROM TABLE1
LEFT JOIN TABLE2 ON TABLE2.TABLE2PK = TABLE1.FIELD1
WHERE TABLE2.TABLE2PK IS NULL
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 Simple FK on TABLE2 on different field
SELECT 
       'SAMPLE_TABLE1_FIELD1 Simple FK on TABLE2 on different field' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'SAMPLE_TABLE1_FIELD1 Simple FK on TABLE2 on different field' as MESSAGE
FROM TABLE1
LEFT JOIN TABLE2 ON TABLE2.TABLE2FIELD = TABLE1.FIELD1
WHERE TABLE2.TABLE2PK IS NULL
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 with FK checking two field correlation as message
SELECT 
       'SAMPLE_TABLE1_FIELD1 with FK checking two field correlation as message' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 cannot be before TABLE2.TABLE2FIELD' as MESSAGE
FROM TABLE1
LEFT JOIN TABLE2 ON TABLE2.TABLE2FIELD = TABLE1.FIELD1
WHERE TABLE1.FIELD1 < TABLE2.TABLE2FIELD
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 with FK checking two field correlation as message and fix
SELECT 
       'SAMPLE_TABLE1_FIELD1 with FK checking two field correlation as message and fix' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 cannot be before TABLE2.TABLE2FIELD' as MESSAGE
FROM TABLE1
LEFT JOIN TABLE2 ON TABLE2.TABLE2FIELD = TABLE1.FIELD1
WHERE TABLE1.FIELD1 < TABLE2.TABLE2FIELD
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 NOT_NULL with simple fix update
SELECT 
       'SAMPLE_TABLE1_FIELD1 NOT_NULL with simple fix update' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is null' as MESSAGE,
       'UPDATE TABLE1 SET FIELD1 = "" WHERE TABLE1.TABLE1PK = ' || TABLE1.TABLE1PK || '' as FIX
FROM TABLE1
WHERE TABLE1.FIELD1 IS NULL
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 NOT_NULL with simple fix DELETE
SELECT 
       'SAMPLE_TABLE1_FIELD1 NOT_NULL with simple fix DELETE' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is null' as MESSAGE
FROM TABLE1
WHERE TABLE1.FIELD1 IS NULL
;

-- Rule ID: SAMPLE_TABLE1_FIELD1 NOT_NULL with copmplex sql
SELECT 
       'SAMPLE_TABLE1_FIELD1 NOT_NULL with copmplex sql' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 is null' as MESSAGE,
       'UPDATE TABLE1 SET FIELD1 = "unknow" WHERE TABLE1.TABLE1PK = ' || TABLE1.TABLE1PK || '' as FIX
FROM TABLE1
WHERE TABLE1.FIELD1 IS NULL
;

-- Rule ID: FREE FORM CHECK
SELECT 
       'FREE FORM CHECK' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       NULL as SOURCE_TABLE_FIELD,
       NULL as SOURCE_TABLE_FIELD_VALUE,
       'N/A of TABLE1 con condizioni custom' as MESSAGE
FROM TABLE1
;

-- Rule ID: FREE FORM CHECK con FK
SELECT 
       'FREE FORM CHECK con FK' as ID,
       'E' as SEVERITY,
       'TABLE1' as SOURCE_TABLE,
       TABLE1.TABLE1PK as SOURCE_TABLE_PK,
       'FIELD1' as SOURCE_TABLE_FIELD,
       TABLE1.FIELD1 as SOURCE_TABLE_FIELD_VALUE,
       'FIELD1 of TABLE1 con condizioni custom' as MESSAGE
FROM TABLE1
LEFT JOIN TABLE2 ON TABLE2.TABLE2FIELD = TABLE1.FIELD1
WHERE TABLE2.TABLE2PK IS NULL
;

